#!/bin/bash

# This is a wrapper script that runs the init script with minimal output
# It's useful when you don't want to see all the verbose logging

# Set verbosity to 0 (minimal)
export DEBUG_VERBOSITY=0

# Capture stderr and filter only important messages
# Exclude common warnings about missing functions and RC files
/home/es/lab/bin/init 2>&1 | grep -E 'Starting main|completed successfully|CRITICAL' | \
  grep -v "RC file" | \
  grep -v "Function .* not found" | \
  grep -v "Failed to register function" | \
  grep -v "WARNING"

# Print a simple success message if init exited successfully
exit_code=${PIPESTATUS[0]}
if [ $exit_code -eq 0 ]; then
  echo "✓ Initialization completed successfully"
else
  echo "✗ Initialization failed with status $exit_code"
fi

# Pass the exit status of init
exit $exit_code
