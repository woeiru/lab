#!/bin/bash
#
# -----------------------------------------------------------------------------
# Runtime Initialization Constants
# -----------------------------------------------------------------------------
# Purpose:     Define all runtime constants and variables used across the system.
# File:        .lab/cfg/core/ric
#
# Description: This file initializes global constants and variables for file paths,
#              logging configurations, directory structures, and other runtime
#              parameters essential for the 'lab' project. It serves as the
#              central repository for system-wide settings.
#
# Dependencies: None. Assumes BASE_DIR may be predefined in the sourcing
#               environment if used by variables within this file.
#
# Usage:       Sourced during system initialization (e.g., by .lab/bin/init)
#              to establish the runtime environment.
#
# Notes:       Review and update paths and default values as per deployment needs.
# -----------------------------------------------------------------------------


# Level 1 directories
declare -g LAB_DIR ALA_DIR BAS_DIR CON_DIR DIC_DIR
LAB_DIR="${LAB_DIR:-/home/es/lab}"
ARK_DIR="${ARK_DIR:-$LAB_DIR/ark}"
BAS_DIR="${BAS_DIR:-$LAB_DIR/bas}"
CON_DIR="${CON_DIR:-$LAB_DIR/con}"
DIC_DIR="${DIC_DIR:-$LAB_DIR/dic}"
export ALA_DIR LAB_DIR BAS_DIR CON_DIR DIC_DIR

# Runtime files - consolidated into init file
declare -ga RC_FILES=()
export RC_FILES

# Runtime configuration files - consolidated into init file
declare -A rc=()
export rc

# Constants files
declare -g MDE_FILE RDE_FILE RUC_FILE
MDE_FILE="$DIC_DIR/mde"
RDE_FILE="$DIC_DIR/rde"
RUC_FILE="$DIC_DIR/ruc"
export MDE_FILE RDE_FILE RUC_FILE

# Log and temp file paths
declare -g LOG_DIR TMP_DIR
LOG_DIR="${LOG_DIR:-${BASE_DIR}/.log}"
TMP_DIR="${TMP_DIR:-${BASE_DIR}/.tmp}"
export LOG_DIR TMP_DIR

# Log files
declare -g ERROR_LOG ERROR_COUNT_FILE ERROR_STATE_FILE
declare -g LOG_STATE_FILE LOG_DEBUG_FILE
declare -g LOG_FILE # For lo1 module
declare -g LO2_LOG_FILE # For lo2 module
declare -g TME_STATE_FILE TME_LEVELS_FILE TME_LOG_FILE
ERROR_LOG="${LOG_DIR}/err.log"
ERROR_COUNT_FILE="${TMP_DIR}/err_count"
ERROR_STATE_FILE="${TMP_DIR}/err_state"
LOG_STATE_FILE="${TMP_DIR}/log_state"
LOG_DEBUG_FILE="${LOG_DIR}/debug.log"
LOG_FILE="${LOG_DIR}/lo1.log" # Definition for lo1.log
LO2_LOG_FILE="${LOG_DIR}/lo2.log" # Definition for lo2.log
TME_STATE_FILE="${TMP_DIR}/tme_state"
TME_LEVELS_FILE="${TMP_DIR}/tme_levels"
TME_LOG_FILE="${LOG_DIR}/tme.log"
export ERROR_LOG ERROR_COUNT_FILE ERROR_STATE_FILE
export LOG_STATE_FILE LOG_DEBUG_FILE
export LOG_FILE LO2_LOG_FILE # Export new log file vars
export TME_STATE_FILE TME_LEVELS_FILE TME_LOG_FILE

# Environment configuration path
declare -g ENV_CONFIG_DIR
ENV_CONFIG_DIR="${LAB_DIR}/cfg/depl"
export ENV_CONFIG_DIR

# Deployment source code path
declare -g FUN_DIR
FUN_DIR="${LAB_DIR}/src/depl" # Corrected path
export FUN_DIR

# Runtime configuration
declare -g CACHE_CLEANUP_INTERVAL
CACHE_CLEANUP_INTERVAL=300  # 5 minutes
export CACHE_CLEANUP_INTERVAL

# Generation folders
declare -ga GENERATION_FOLDERS
GENERATION_FOLDERS=(env fun gen)
export GENERATION_FOLDERS

# Flag to indicate constants are loaded
declare -g CONS_LOADED=1
export CONS_LOADED
