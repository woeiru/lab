#!/bin/bash

# Main configuration file
# This file sources the modular components and handles the main execution

# Define the directory of the script using a POSIX-compliant method
DIR="$( cd "$( dirname "$(readlink -f "${BASH_SOURCE[0]}")" )" >/dev/null 2>&1 && pwd )"
PARENT_DIR="$DIR/.."

# Source modular components
source "$DIR/rc0"
source "$DIR/rc1"
source "$DIR/rc2"
source "$DIR/rc3"

# Source all files in lib and var folders
source_lib_and_var() {
    local lib_dir="$PARENT_DIR/lib"
    local var_dir="$PARENT_DIR/var"

    # Source all .bash files in lib directory
    for file in "$lib_dir"/*.bash; do
        if [ -f "$file" ]; then
            source "$file"
            echo "Sourced lib file: $file"
        fi
    done

    # Source all .conf files in var directory
    for file in "$var_dir"/*.conf; do
        if [ -f "$file" ]; then
            source "$file"
            echo "Sourced var file: $file"
        fi
    done

    # Set environment variable to indicate successful sourcing
    export LABS_ENVIRONMENT_SOURCED=1
    echo "All lib and var files sourced successfully"
}

# Main execution
main() {
    # Call functions from modules
    setup_aliases
    setup_navigation
    setup_environment

    # Source lib and var files
    source_lib_and_var
}

# Execute main function
main
