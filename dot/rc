#!/bin/bash

# Main configuration file
# This file sources the modular components and handles the main execution

# Define the directory of the script using a POSIX-compliant method
DIR="$( cd "$( dirname "$(readlink -f "${BASH_SOURCE[0]}")" )" >/dev/null 2>&1 && pwd )"
#PARENT_DIR="$DIR/.."
PARENT_DIR="/root/lab"

# Source modules
source "$DIR/rc0"
source "$DIR/rc1"
source "$DIR/rc2"
source "$DIR/rc3"

sourcing() {
    log "HEADER" "Starting sourcing"
    local dirs=("lib" "var")
    local extensions=("bash" "conf")

    for i in "${!dirs[@]}"; do
        local dir="$PARENT_DIR/${dirs[i]}"
        local ext="${extensions[i]}"

        for file in "$dir"/*."$ext"; do
            if [ -f "$file" ]; then
                source "$file"
                log "INFO" "Sourced ${dirs[i]} file: $file"
            fi
        done
    done

    # Set environment variable to indicate successful sourcing
    export LABS_ENVIRONMENT_SOURCED=1
    echo "All lib and var files sourced successfully"
}

# Main setup execution
setup() {
    # Call functions from modules
    setup_aliases
    setup_navigation
    setup_environment

    # Source lib and var files

}

# Execute main function
setup
sourcing
